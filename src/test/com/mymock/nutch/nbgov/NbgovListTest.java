package com.mymock.nutch.nbgov;

import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.equalTo;
import static org.junit.Assert.assertTrue;

import java.util.List;
import java.util.regex.Matcher;

import org.junit.Test;

import com.mymock.nutch.BaseFort;

public class NbgovListTest extends BaseFort {

	private static final String content = "<datastore><totalrecord>3719</totalrecord><totalpage>248</totalpage><recordset><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/27/art_167_362116.html' class='bt_content_w' title='海曙连续四年拍视频自曝“脏乱差”' target='_blank'>海曙连续四年拍视频自曝“脏乱差”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-27</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/27/art_167_362114.html' class='bt_content_w' title='鄞州启动“斑马线上见文明”活动' target='_blank'>鄞州启动“斑马线上见文明”活动</a></td><td width='100' align='center' style='font-size:15px'>2016-05-27</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/27/art_167_362113.html' class='bt_content_w' title='宁波以立法引导和规范文明行为' target='_blank'>宁波以立法引导和规范文明行为</a></td><td width='100' align='center' style='font-size:15px'>2016-05-27</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/26/art_167_361985.html' class='bt_content_w' title='宁波太平洋慈善基金会发放善款近3000万元' target='_blank'>宁波太平洋慈善基金会发放善款近3000万元</a></td><td width='100' align='center' style='font-size:15px'>2016-05-26</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/26/art_167_361769.html' class='bt_content_w' title='“百姓城管”扮靓江东' target='_blank'>“百姓城管”扮靓江东</a></td><td width='100' align='center' style='font-size:15px'>2016-05-26</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/25/art_167_361681.html' class='bt_content_w' title='宁波市推动工程车礼让斑马线常态化' target='_blank'>宁波市推动工程车礼让斑马线常态化</a></td><td width='100' align='center' style='font-size:15px'>2016-05-25</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/25/art_167_361657.html' class='bt_content_w' title='余姚市持续开展城区交通秩序整治' target='_blank'>余姚市持续开展城区交通秩序整治</a></td><td width='100' align='center' style='font-size:15px'>2016-05-25</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/24/art_167_361108.html' class='bt_content_w' title='市老年疗养院举行“慈善一日捐”活动' target='_blank'>市老年疗养院举行“慈善一日捐”活动</a></td><td width='100' align='center' style='font-size:15px'>2016-05-24</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/23/art_167_360652.html' class='bt_content_w' title='镇海区启动2016年慈善助学活动' target='_blank'>镇海区启动2016年慈善助学活动</a></td><td width='100' align='center' style='font-size:15px'>2016-05-23</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/23/art_167_360600.html' class='bt_content_w' title='宁海团县委结对贵州贞丰县帮扶贫困学子实现成长梦' target='_blank'>宁海团县委结对贵州贞丰县帮扶贫困学子实现成长梦</a></td><td width='100' align='center' style='font-size:15px'>2016-05-23</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/23/art_167_360592.html' class='bt_content_w' title='海曙望春“和谐社区群众满意度”测评交第三方' target='_blank'>海曙望春“和谐社区群众满意度”测评交第三方</a></td><td width='100' align='center' style='font-size:15px'>2016-05-23</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/20/art_167_360478.html' class='bt_content_w' title='余姚出租汽车协会开展“礼让斑马线”活动' target='_blank'>余姚出租汽车协会开展“礼让斑马线”活动</a></td><td width='100' align='center' style='font-size:15px'>2016-05-20</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/20/art_167_360466.html' class='bt_content_w' title='江东区召开第四次慈善大会' target='_blank'>江东区召开第四次慈善大会</a></td><td width='100' align='center' style='font-size:15px'>2016-05-20</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/20/art_167_360460.html' class='bt_content_w' title='宁波石化区慈善一日捐募集善款近70万' target='_blank'>宁波石化区慈善一日捐募集善款近70万</a></td><td width='100' align='center' style='font-size:15px'>2016-05-20</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/20/art_167_360206.html' class='bt_content_w' title='宁波推出大型旅游志愿行动' target='_blank'>宁波推出大型旅游志愿行动</a></td><td width='100' align='center' style='font-size:15px'>2016-05-20</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/19/art_167_359995.html' class='bt_content_w' title='海曙“金种子”支持150余个“微公益”' target='_blank'>海曙“金种子”支持150余个“微公益”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-19</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/19/art_167_360039.html' class='bt_content_w' title='招宝山举行庆祝文明楼群创建30周年' target='_blank'>招宝山举行庆祝文明楼群创建30周年</a></td><td width='100' align='center' style='font-size:15px'>2016-05-19</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/18/art_167_359929.html' class='bt_content_w' title='北仑区综合行政执法局开展文明创建顽疾治理行动' target='_blank'>北仑区综合行政执法局开展文明创建顽疾治理行动</a></td><td width='100' align='center' style='font-size:15px'>2016-05-18</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/18/art_167_359928.html' class='bt_content_w' title='“慈善一日捐”启动 港城涌动爱心潮' target='_blank'>“慈善一日捐”启动 港城涌动爱心潮</a></td><td width='100' align='center' style='font-size:15px'>2016-05-18</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/18/art_167_359824.html' class='bt_content_w' title='白云街道社会组织撑起服务民生“一片天”' target='_blank'>白云街道社会组织撑起服务民生“一片天”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-18</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/18/art_167_359790.html' class='bt_content_w' title='慈溪残疾人志愿者服务市民' target='_blank'>慈溪残疾人志愿者服务市民</a></td><td width='100' align='center' style='font-size:15px'>2016-05-18</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/17/art_167_359661.html' class='bt_content_w' title='大堰村规民约引来央视《走遍中国》栏目组' target='_blank'>大堰村规民约引来央视《走遍中国》栏目组</a></td><td width='100' align='center' style='font-size:15px'>2016-05-17</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/17/art_167_359598.html' class='bt_content_w' title='九龙湖志愿者公益服务常态化' target='_blank'>九龙湖志愿者公益服务常态化</a></td><td width='100' align='center' style='font-size:15px'>2016-05-17</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/17/art_167_359573.html' class='bt_content_w' title='宁波三家庭被评“全国五好文明家庭”' target='_blank'>宁波三家庭被评“全国五好文明家庭”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-17</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/17/art_167_359585.html' class='bt_content_w' title='北仑举行“阳光路上 爱是你我”大型公益慈善活动' target='_blank'>北仑举行“阳光路上 爱是你我”大型公益慈善活动</a></td><td width='100' align='center' style='font-size:15px'>2016-05-17</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/16/art_167_359441.html' class='bt_content_w' title='镇海区残联推公众号 让残疾人用指尖畅游世界' target='_blank'>镇海区残联推公众号 让残疾人用指尖畅游世界</a></td><td width='100' align='center' style='font-size:15px'>2016-05-16</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/16/art_167_359374.html' class='bt_content_w' title='海曙志愿者成立“家庭帮帮团”' target='_blank'>海曙志愿者成立“家庭帮帮团”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-16</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/16/art_167_359370.html' class='bt_content_w' title='象山举行换书夜市活动倡导全民阅读' target='_blank'>象山举行换书夜市活动倡导全民阅读</a></td><td width='100' align='center' style='font-size:15px'>2016-05-16</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/14/art_167_359333.html' class='bt_content_w' title='宁波加快建设全域化高水平文明之城' target='_blank'>宁波加快建设全域化高水平文明之城</a></td><td width='100' align='center' style='font-size:15px'>2016-05-14</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/13/art_167_359094.html' class='bt_content_w' title='海曙推出20个助残创新项目' target='_blank'>海曙推出20个助残创新项目</a></td><td width='100' align='center' style='font-size:15px'>2016-05-13</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/13/art_167_359090.html' class='bt_content_w' title='邹黎明入选省“最美残疾人”' target='_blank'>邹黎明入选省“最美残疾人”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-13</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/12/art_167_356681.html' class='bt_content_w' title='江北文教社会组织走出特色发展之路' target='_blank'>江北文教社会组织走出特色发展之路</a></td><td width='100' align='center' style='font-size:15px'>2016-05-12</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/12/art_167_356649.html' class='bt_content_w' title='“博爱甬城”收到首笔50万捐款' target='_blank'>“博爱甬城”收到首笔50万捐款</a></td><td width='100' align='center' style='font-size:15px'>2016-05-12</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/11/art_167_356443.html' class='bt_content_w' title='江北文教：聚焦补齐短板 优化城市供给' target='_blank'>江北文教：聚焦补齐短板 优化城市供给</a></td><td width='100' align='center' style='font-size:15px'>2016-05-11</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/11/art_167_356442.html' class='bt_content_w' title='海曙打通社区服务“任督二脉”' target='_blank'>海曙打通社区服务“任督二脉”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-11</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/11/art_167_356439.html' class='bt_content_w' title='镇海骆驼街道全民开赞“行善之星”' target='_blank'>镇海骆驼街道全民开赞“行善之星”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-11</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/11/art_167_356420.html' class='bt_content_w' title='“阿拉伴”接力跑首进农村' target='_blank'>“阿拉伴”接力跑首进农村</a></td><td width='100' align='center' style='font-size:15px'>2016-05-11</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/10/art_167_355644.html' class='bt_content_w' title='宁波杭州湾新区总工会表彰6家“职工示范生活区”' target='_blank'>宁波杭州湾新区总工会表彰6家“职工示范生活区”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-10</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/10/art_167_355602.html' class='bt_content_w' title='镇海慈善总会预算支出2100万元' target='_blank'>镇海慈善总会预算支出2100万元</a></td><td width='100' align='center' style='font-size:15px'>2016-05-10</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/10/art_167_355584.html' class='bt_content_w' title='招宝山街道：家门口牵起互助互惠之手' target='_blank'>招宝山街道：家门口牵起互助互惠之手</a></td><td width='100' align='center' style='font-size:15px'>2016-05-10</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/10/art_167_355650.html' class='bt_content_w' title='白鹤街道两新组织服务联盟开展阳光助残活动' target='_blank'>白鹤街道两新组织服务联盟开展阳光助残活动</a></td><td width='100' align='center' style='font-size:15px'>2016-05-10</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/9/art_167_355437.html' class='bt_content_w' title='余姚市表彰十佳“最美残疾人”“最美助残人”' target='_blank'>余姚市表彰十佳“最美残疾人”“最美助残人”</a></td><td width='100' align='center' style='font-size:15px'>2016-05-09</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/9/art_167_355430.html' class='bt_content_w' title='违停短信通知效果明显 镇海城管提升服务水平' target='_blank'>违停短信通知效果明显 镇海城管提升服务水平</a></td><td width='100' align='center' style='font-size:15px'>2016-05-09</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/9/art_167_355421.html' class='bt_content_w' title='全国红会系统首创博爱甬城APP上线' target='_blank'>全国红会系统首创博爱甬城APP上线</a></td><td width='100' align='center' style='font-size:15px'>2016-05-09</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/8/art_167_354701.html' class='bt_content_w' title='海曙“社区顽疾会诊会”季季开' target='_blank'>海曙“社区顽疾会诊会”季季开</a></td><td width='100' align='center' style='font-size:15px'>2016-05-08</td></tr>]]></record><record><![CDATA[<tr><td width='10' height='28' align='center'><span><img src='/picture/1/s1603211448599678585.png' align='absmiddle' border='0'></span></td><td align='left'><a href='http://gtoc.ningbo.gov.cn/art/2016/5/8/art_167_354703.html' class='bt_content_w' title='宁海510条家规家训挂上村民家' target='_blank'>宁海510条家规家训挂上村民家</a></td><td width='100' align='center' style='font-size:15px'>2016-05-08</td></tr>]]></record></recordset></datastore>";

	@Test
	public void headers() {
		NbgovHttpCustom hpc = NbgovConfHolder.INSTANCE.get();
		assertThat(hpc.getHeaders().get("Content-type"), equalTo("application/x-www-form-urlencoded; charset=UTF-8"));
		assertThat(hpc.getUrls().get("jrgz").getFormDatas().get("webname"), equalTo("中国·宁波+公民站"));
	}
	
	@Test
	public void testMeta() {
		Matcher m = NbgovListFetcher.meta.matcher(content);
		assertTrue("should match totalrecord.", m.lookingAt());
		assertThat("should hoder totalrecord in group 1.", m.group(1), equalTo("3719"));
	}
	
	@Test
	public void testAlink() {
		NbgovListFetcher nf = new NbgovListFetcher();
		List<String> urls = nf.extractLins(content);
		assertThat("should have 45 urls", urls.size(), equalTo(46));
	}
}
